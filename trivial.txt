comment to avoid warning
/* coverity[check_return] */
/* coverity[suspicious_sizeof] */

https://github.com/autozimu/LanguageClient-neovim
https://people.freebsd.org/~gahr/lc.vim

quick guides to
	format strings
	tagging
	alias labels
		document and asciinema alias tags:

doc tags in alias, mail to user ml
	add to dyk

good first issue?
	add tag-pattern to the browser -- useful for compose-attach
		if multi-selection is allowed
	fix auto-tag PR first

attach refactor
	libattach
	dlg(view)attach
	pass attach list to functions
		(c.f. tagged emails)

"Out of memory" translation still used?!

note alx: ptr vs pptr

apply colour to a column
	find the index_format node when the `color` command is used
	or when $index_format is set
what about row colours?

extend
	`color header green default '^Subject'`
	to allow partial matches, like status color does
	e.g.
		color header green default '^Subject: (.*)' 1
	match the text of the subject only

$attach_status to configure the AttachBar
	default to "Attachments" ?
	or "Attachments: %n"
	what else could we display?
	cumulative size?
	allow *email* expandos, e.g. To: %t, Subject: %s!

Is this ever true?
	_fmt(OP_SEARCH, N_("search for a regular expression")) \
	or are we always searching for a *pattern*?

for the Menu,
	where is the "deleted" colour?
	where is the dedicated "tagged" colour?
	color index fg bg "~T" !
	create colour "links" first

coverage core (simple)
	command
	config_cache
	neomutt
	much of mailbox

Menu: rename line to row?
	int (*make_entry)(struct Menu *menu, int line, int max_cols, struct Buffer *buf);
	need to fix Menu.search() too

roccoblues
	when you look in buffer.h you'll notice that most of the time str in the name
	signifies a char * but not always. buf_addstr vs. buf_insert. Or buf_startswith
	should be buf_startswith_str because we could also have a buf_startwith(Buffer, Buffer)?

bare mode cf weechat
	wrapping, markers '+', scrollbar
	all interfere with copy'n'paste and urls
	<bare-mode> drop into basic pager -- endwin()
		bind to Ctrl-B
	don't wrap, just dump email to screen
	let terminal do page up / down
	optionally use ansi sequences for urls?
		probably not necessary
	'q' <quit> to exit
	eliminates need for urlview / urlscan
	why not use <pipe-message>cat<enter> ?

unify Address Groups and Alias Tags
	then group patterns match tags
	%c GROUP   messages carbon-copied to any member of GROUP
	%C GROUP   messages either to:, cc: or bcc: to any member of GROUP
	%e GROUP   messages which contain a member of GROUP in the 'Sender' field
	%f GROUP   messages originating from any member of GROUP
	%L GROUP   message either originated or received by any member of GROUP
group commands
	alias        [ -group name ...] key address [ , address ...]
	unalias      [ -group name ...] { * | key ... }
	-------------
	alternates   [ -group name ...] regex [ regex ...]
	unalternates [ -group name ...] { * | regex ... }
	-------------
	group        [ -group name ...] {     -rx regex ... | -addr address ... }
	ungroup      [ -group name ...] { * | -rx regex ... | -addr address ... }
	-------------
	lists        [ -group name ...]       regex [ regex ...]
	unlists      [ -group name ...] { * | regex ... }
	-------------
	subscribe    [ -group name ...]       regex [ regex ...]
	unsubscribe  [ -group name ...] { * | regex ... }
add syntax: <mail>@group to send to entire group?

translations
	need printf format ordering doc
	msgid "Option %s has an invalid type %d"
	msgstr "Le type %2$d de l'option %1$s est invalide"

split colours?
	common enum of domains: MT_INDEX, MT_ALIAS, ...
	private set of colours MT_IND_SUBJECT
	cf ExpandoDomain
	separate `struct RegexColorList IndexList`
	probably means init() and cleanup() functions for each library
	what about parsing?

compose: attach lots of files
	select last attachment
	step-shrink the terminal so selection isn't visible
	selection isn't visible!

docs for expando architecture

dialogs 21 * Local variable address stored in non-local memory
	refactor callers
	dynamically allocate data
	delegate ownership to menu?
		probably doesn't make sense for menu to own it

quoted colours not merged correctly
	color quoted default red
	color body green default .
quoted text should be green red

replicate LOCALES_HACK in the tests
	if nobody complains, deprecate the configure option

merge (almost identical)
	struct Regex *regex_new(const char *str, uint32_t flags, struct Buffer *err)
	struct Regex *mutt_regex_new(const char *str, uint32_t flags, struct Buffer *err)

use to disable emojis?
	set ascii_chars = no
from irc
	dmrz	is there a way to just turn of display off emoji in neomutt?
	dmrz	emoji are displaying wrong for me, and i suspect fixing this would be somewhat complicated, so i'll like to just turn them off
	dmrz	("displaying wrong" = covering multiple terminal lines)
	turned out to be a font problem

bisect
	notmuch backend altering headers!
	adding mbox-style "Status: O" and "Tags: inbox"

update gfx repo compose screenshots/etc with preview window
	check docs/website/etc

flatcap/vim-cpp -> neomutt/vim-neomutt-source ?

MT_COLOR_CONCEAL "conceal" -- not just invisible, not _there_
	could use for signatures, headers (weeding), toggle-quoted, etc
	does conceal '.*' leave a blank line?
		probably, should kill the line
	alternatively, leave blank line, but squash multiple concealed lines
	set conceal_level = [0123]
	toggle conceal_level
		to toggle visibility
	set conceal_char = 'â€ '
		cf vim
	set line default colour to CONCEAL?
		but then we lose the colour for when it's not hidden
		have a line-level bool for conceal?

idea from irc:
	index_format expando for the alias short-name
		alias bob "Robert Smith <rs@example.com>"
	gives "bob" in the index
	how?
		need HashTable of alias short names
variant
	apply colours to address lists (e.g. Index, Compose, etc)
	based on patterns, e.g. "in-address-book", "in-address-group-X"

colour notifications
	might want more distinction for RegexColors
	*which* RegexColor was added / removed
	e.g. { MT_COLOR_BODY, REGEX_ADDED, "http://..." }
		or index into RegexColorList / Array

change the discussion issue template to redirect users to the discussions area

`neomutt -vv` recalc top ten contributors
	(and record the method by which I calc'd it)

syntax highlighting plugin for the Pager
	define rules
	line-matching (equivalent to `color body fg bg pattern`)
	begin-end rules, e.g. signature
rule signature
	apply-to: folder [pattern]  OR  email [pattern]
		folder pattern => folder-hook
		email pattern => message-hook?
	begin-pattern: '^-- $'
	end-pattern:   '^$'
	max-lines: 4
	color: fg bg
	conceal: yes

create "limit" rules for concealing emails?
	muting conversations?

close other repo discussions
closed, locked, pinned issue:
enhancement/idea link / template -> discussions
	"ðŸ›Ÿ I Need Help", "ðŸ’¡ I Have Ideas" "â™¥ï¸ I Want to Help"
pinned issues
	I need help - how to ask for help, how to write a good issue
	I want to help - how to join us
	I want to thank you - star, donate, help, "thanks" -> irc
	link to Discussions

certificates add relatives to timestamps (X ago, for Y)
	see agent.txt

README.md
	warning/note/information/tip blocks!
	> [!NOTE]
	> markdown text
	> [!TIP]
	> [!IMPORTANT]
	> [!WARNING]
	[!note] [!warning] [!tip] [!caution] [!important]
installation
	## Installation
	[![Packaging status](https://repology.org/badge/vertical-allrepos/bat-cat.svg?columns=3&exclude_unsupported=1)](https://repology.org/project/bat-cat/versions)
	https://repology.org/badge/vertical-allrepos/neomutt.svg?columns=3&exclude_unsupported=1

searching the index with `~i REGEX` matching message ids is problematic
	they often contain regex special characters
	alter the docs to make this clear
add a new syntax to the `~i` pattern...
	`~i TEXT`   -- text is regex
	`~i <TEXT>` -- text is literal

Commits as of 2026-01-01
	Year	Mutt	NeoMutt
	2016	 316	    788
	2017	 272	   1615
	2018	 348	   1873
	2019	 419	   1752
	2020	 406	   1070
	2021	 261	   1114
	2022	 130	    714		Feb, Kevin steps back
	2023	  20	   1124
	2024	  10	    603
	2025	  21	    360
	      -------    -------
Total		2203	  11013
		 181	   2801		Post Kevin

in help use 'q' <quit> where data is read-only, e.g. info pages
	accept 'x' <exit> also
elsewhere
	'q' <quit> => save and exit
	'x' <exit> => exit without saving

get neomutt on every available "awesome" list
	https://www.linuxlinks.com/best-free-open-source-console-email-clients/
	after, list the lists on neomutt.org

~/.config/neomutt/theme.rc
	file or symlink

how to end-to-end test the autocrypt functions?
	discussion

test build with ubsan
	weekly github action

Config system
	reduce all error messages to error codes
	there're a finite number of ways the config system can fail
	possible for the 'generic' failures, "Option %s may not be negative"
	but setting a regex or expando can return custom errors

colour - what happens if you set both (simple/palette) and truecolor?
	we want to share both; if $color_directcolor is set then use
	truecolor, else use (simple/palette)
	avoids the need for multiple theme files
	AttrColor needs link to other AttrColors
		need refcounting
		or be able to survive the *linked* object disappearing
	Use linked colours to support truecolor -> simple fallbacks

SimpleBar / ExpandoBar
	are they compatible?
	can they be merged?

weekly build action with
	-D_FORTIFY_SOURCE=1 or 2
	24 * warning: dereferencing type-punned pointer might break strict-aliasing rules
	e.g. mutt/list.c:153:18:

air (on irc)
	#define SUPPRESS_UNUSED_WARNING(v) (void)v;
	#define SUPPRESS_UNUSED_RESULT_WARNING(fn_call) do{if(fn_call){/*warn_unused_result*/}}while(0)

find clean/dirty strwidth() / wcwidth() uses

release: commit count
	in folded section?
	<summary>Release stats</summary>

fold lines that don't match the search pattern
	:set foldenable foldmethod=expr foldminlines=0 foldexpr=getline(v:lnum)!~@/

expando for a divider character
	if ($ascii_chars = yes), then use ascii | pipe
	otherwise use unicode â”‚ vertical bar
	what char? %| is already used for eol-padding
		eol-padding isn't needed, %*X or %>* will do
	better that raw | char, because it can be coloured
		color sidebar_divider -> divider

colour setting
	if rgb but not truecolor => error, unless...
	if colour is already set, don't error, but log
	then, theme can contain multiple settings
	where the last viable setting wins
e.g. same object, but increasing colour depth
	color object red      green
	color object color123 color   214
	color object #aabbcc  #112233
increasing subtlety!

filter synonyms and deprecated out of get_elem_list()
	so that the callers don't have to

pass Keymaps to km_init() and all children?
	where else is it used?

weechat logs to private repo
	daily auto-commit

nntp feature request
	Currently, neomutt downloads newsgroup descriptions from the server only. Would
	there be a chance these descriptions could be saved to a file? This could then
	be used to display descriptions sent by the server (and stored locally) OR not
	sent by the server, in case one wanted to add their own descriptions or even
	change the current ones.
	For example, slrn, by default, adds the descriptions to a .jnewsrc.dsc file
	(basically whatever you name the newsrc file, with a '.dsc' extension and
	resides in the same directory you configure for your .jnewsrc file), in this
	format: <newsgroup>:<description>
	tin, by default, uses a file called 'newsgroups' in the account folder, which
	uses this format: <newsgroup><space><description>

repaint()
	fprintf(stderr, "\033[s\033[9;24H\033[1;48;2;0;96;96m\033]8;id=1;https://neomutt.org/guide/reference#alias-file\007alias_\033]8;;\007\033[0m\033[u");
	fprintf(stderr, "\033[s\033[15;24H\033[1;48;2;0;96;96m\033]8;id=1;https://neomutt.org/guide/reference#alias-file\007file\033]8;;\007\033[0m\033[u");

sort out
	z-sort (271)
	bin (176)

extract data from
	site repo branches

jindraj: gmail login, app passwords
	The option to generate app passwords is hidden until 2FA is enabled.

dynamic help bar
	irc: Bombo
	maybe like the 'bind/macro index ...' index,show_in_help or as last arg, 'bind compose <insert> attach-file show_in_help_line'
show_in_help flag should apply to all menus mentioned
we'd have to add a flag to the key bindings,
change the hard-coded bindings to use the flag
should we add to the end of the list, risking not being visible
or the beginning of the list risking other useful stuff getting lost?
unbind would clear the flag
	this would allow user to clear all the help and create their own
	unbind help; rebind help (no flag)
add a $help_bar_format option
	defaults to "%b" keybindings.  what else?
	allows use to display what they want
	but help bar is global, the text needs to be per-dialog

mutt_debug(LL_DEBUG1, "FILE:%d, offset %ld, bytes_read %ld\n", fileno(fp), offset, *bytes_read);

irc suggestion: re learning curve
	personally what would make it less steep would be a "primer HOWTO" with things like
	"How do I compose and send an email?"
	"How do I browse folders?"
	"How do I search in a folder/ in all folders?" and so on
	basically a new user will want to (at least): read incoming email, mark
	them as read/unread, move them to folders (or tag if using notmuch),
	list (index) | directories compose a new message and send it

color toggle object [pattern]
	temporarily change the visibility of a colour
	idea: temporarily highlight some part of the text

pager markers broken (may be very historic)
	https://gist.github.com/gahr/557a2e7fda9309a22e4656aa1d417ba4
	bisect, check mutt

<toggle-quoted> doesn't honour $toggle_quoted_show_levels correctly
if there are two distinct quoting styles
set toggle_quoted_show_levels = 2 only shows the first style
i.e. `>` and `> >` but not `|` and `| |`
	> 58 104 105 157 127 40 173
	> > 87 1 50 92 44 16 195 33
	> > > 177 156 31 187 29 65
	4 79 150 45 118 113 9 180
	| 46 162 13 14 158 183 81
	| | 193 75 122 68 21 174
	| | | 197 199 66 126 83 7

upstream check/merge

browser tabs?
	implement tabbed-help-page first

terminal window focus in/out https://unix.stackexchange.com/a/480138

upstream: 0e32b9774
	map to change-folder (DlgBrowser)
	index/pager
	{ "browse-mailboxes",          OP_MAIN_BROWSE_MAILBOXES,          "y" },
	{ "browse-mailboxes-readonly", OP_MAIN_BROWSE_MAILBOXES_READONLY, NULL },

irc: jxl: is there a way to list the flags currently set for the message under the cursor? something in the same vein as the what-key function?

irc: rkta: I really would like mutt to warn me when I reply to an email and already have a draft which is a reply to the same message id.

dynamically change format strings
	need generic format string editor
	cf htop config

history: which constants are used in the history file?
	MENU_INDEX enum?

browser option to scan subdirs for {cur,new,tmp}
	so that they can be highlighted as mailboxes
	already done, just no feedback to user
	icon command

idea
	macro index,pager d "<clear-flag>n<clear-flag>o<clear-flag>f<delete-message>"
	NOPE each <clear-flag> moves focus
	macro index,pager d "<enter-command>set resolve=no<enter><clear-flag>n<clear-flag>o<clear-flag>!<enter-command>set resolve=yes<enter><delete-message>"
	how could you "checkpoint" config?
	<create-checkpoint>alter config; do stuff<restore-checkpoint>

use r.h.s of help-bar to display tabs of backgrounded compose sessions

drop mono command from the docs
	examples, etc
	sample themes are tricky

Naming of ARRAYs?
	ARRAY_HEAD(AppleArray,   struct Apple);      /// Array of objects
	ARRAY_HEAD(BananaPArray, struct Banana *);   /// Array of pointers

doxy:
	https://neomutt.org/code/annotated.html		some missing descriptions for structs

madduck, irc 2025-10-30
	space actually works. I can enter it, but once I entered it, there is no more tab completion at all. this is what confused me.
	Take /srv/with space/foo
	if I hit /srv/w<tab>, I am left at "/srv/with". If I enter "/srv/with <tab>", nothing happens, I am not offered the interactive browser either.
	if I hit /srv/w<tab><tab>, I am shown the browser and I can now navigate to "/srv/with space/foo" just fine, â€¦ but then what?
	The browser is now in the right directory, but the prompt down below still shows "/srv/with" and if I exit the browser with 'q', that is where I am left.
	There seems to be no way to "transfer" the browser location to the command prompt, which is sort of what I would expect. Why else the browser?
In Mutt "abc def/<tab><tab>" opens the browser

AI Usage
	Create Label for PRs
	How to Credit AI?
	Fedora suggests using a commit trailer such as "Assisted-by: <AI tool name>" to make that clear in project history

themes
	https://sphinx-themes.org/
	https://jothepro.github.io/doxygen-awesome-css/

.github README
	welcome

modernise all the sample configs
	underscore config names, etc
	# vim: syn=neomuttrc

Find more Linked List Nodes, to replace with ARRAY, e.g.
	see agent.txt

if "theme" (GUI) is separate config file, "keys"/"bindings" should be too
if theme config file is present, ignore /etc/neomuttrc colours? HOW
	=> good clean slate
	don't set default colours either?
	means checking for existence of *user* config before reading *system* config

keybindings for Editor (OpEditor)
	OP_EDITOR_MAILBOX_CYCLE needs splitting out
		how does that work with bindings?
		or can it return FR_UNKNOWN if there's no Mailbox
	only used when we're in the index
	OP_EDITOR_COMPLETE/OP_EDITOR_COMPLETE_QUERY
	OP_EDITOR_HISTORY_*?  is history *always* available?
	OP_HELP/OP_REDRAW? always available?

$my_unset_var resolves to literal "$my_unset_var"
	unset my_vars should expand to an empty string
	need example prompt where this occurs

reorg /neo/github /github mail folders

github action to keep gitlab/etc in sync

<tag-toggle> or <tag-invert> -- invert selection
	trivial to implement in lua!

auto-completion
	find every point of text entry
	determine what completion might be possible
	implement it
need generic way to complete command string (on <enter-command>)
is it possible to *highlight* when auto-completion is *available*!
e.g. user types `:help` and a light goes on (optionally)
could show possibilities in a one-liner window above the prompt
(poor man's popup window / step towards a popup window)
	| color config patterns (+3 more) |
	|:help
or
	| peck pepper peter picked pickled (+2 more) |
	|Enter filename: p
need a few simple completion classes:
	predictable: bool/quad/enum, colour, config option, function, command, menu names,
	unpredictable: file-only, file-or-dir, dir-only, dir-or-mailbox, mailbox
	misc: tags/labels (in-use, recently-used), addresses?
even if we can't auto-complete, can we add value with a description?
	| Number of foos to use |
	|:set option =
or
	| Number between 10 and 50 |
	|:set option =
enum completion-type: [off|demand|pre-emptive]
	off: none
	demand: when they hit <tab>
	pre-emptive: even without <tab>
		(need friendlier names)
	[off,tab,magic]?
	[off,tab,auto]?

! <shell-escape>  allow Ctrl-D to cancel the prompt?
	Ctrl-G already works

irc/mgedmin
	(after doing a <tag-prefix><save-message>)
	it would make sense to move to the next undeleted if the current line is on one of the tagged emails that just got saved and deleted

irc/madduck/mgedmin
	browser dir selection doesn't work
	<generic-select-entry> and <descend-directory> are messed up

browser: default folder_format="%2C %t %N %F %2l %-8.8u %-8.8g %8s %d %i"
	is laggy when navigating
	my folder_format="%2C %t %?N?%3N&   ? %f"
	isn't laggy

folder_format expandos for numeric uid,gid
	{long-name} only
	need docs

browser, cache uid->string, gid->string in a HashTable

alias completion on ','
	<mail>name,
	when ',' is typed (unless quoted/escaped)
	check the previous clause for '@'
	No '@' => alias.  Expand the alias if possible
	if not, highlight it, e.g. red undercurl!
	`bind editor , complete` maybe
	which text does auto-complete get?
	how much text is it allowed to edit?

editor
	auto-completion needs to change the editor's keybindings
	default is <tab> -> <complete>
	extra is <Ctrl-T> -> <complete-query>
	need `,` -> <complete-alias>
they should *all* be added by the caller
editor calls km_dokey() with *its* keymap AND the PROVIDED keymap
	NO.  how does that work with config keybindings?

group info commands into tabs.  HOW?
	if user does `:set` then `:color` then `:hooks`
	rather than have three overlaid Pagers
	add a tab to the current display and focus it
multi-tab info pages: distinguish <quit> vs <exit>?
	<quit> close this page (equiv Ctrl-W)
	<exit> close all pages (equiv Ctrl-Q)

browser auto-tag behaviour -- need list of every Menu
	categorise how menu is used w.r.t. selection / tagging
		single vs multi-selection
	/home/mutt/work/keymaps-notes/m1
only dialogs implement Menu->tag()
	alias/dlg_alias.c:139:     int alias_tag         (struct Menu *menu, int sel, int act)
	alias/dlg_query.c:166:     int query_tag         (struct Menu *menu, int sel, int act)
	attach/dlg_attach.c:153:   int attach_tag        (struct Menu *menu, int sel, int act)
	browser/dlg_browser.c:687: int file_tag          (struct Menu *menu, int sel, int act)
	compose/attach.c:202:      int compose_attach_tag(struct Menu *menu, int sel, int act)
	index/functions.c:2352:    int op_tag            (struct IndexSharedData *shared, struct IndexPrivateData *priv,

deprecate
	virtual_spoolfile
	OP_SIDEBAR_TOGGLE_VIRTUAL

Change to use the pager?
	`:attachments ?`

squash 'for' branches

compose
	mutt_make_multipart()
	mutt_remove_multipart()

Editor
	<space> test FR_UNKNOWN for literal space
		NOPE
		FR_NOACTION works
	make FR_UNKNOWN conditional on having Maiboxes
	if a macro/push puts "apple banana" (with a space) into the queue
	then <mailbox-cycle> shouldn't be triggered
	<mailbox-cycle> should only happen in *interactive* sessions
	what is <complete-query> doing in OpEditor?
	custom completion should be added by caller.  HOW?

VIM: update syntax.rc
	after command renaming / synonym-ing

clang-tidy everything
	pick useful rules

sidebar is a Menu except that Menu doesn't have a grey pre-selection
Menu: rows, format string, selection, paging, limit/filter
Sidebar doesn't have %C(num) row numbers, no  12<enter> for navigation

docs: reference -> ref?
	or permanent redirect from
		(for permanent short urls)
	how	-> howto
	h	-> howto
	tut	-> tutorial
	t	-> tutorial
	exp	-> explanation
	x	-> explanation
	ref	-> reference
	r	-> reference
	ref/cfg	-> reference/config
	ref/cmd	-> reference/command
		etc

is $devel_security still referenced?
	still needed?

tweak Quickhl colours

:alias (no params) -> <alias-dialog>
	currently the function is index-only
	can it be run globally
	<alias-dialog> -> actions -> send message -> original place

translation action
	âˆ€ push to [translate], run `msgcat --no-wrap`
	if there are any differences create a fixup commit
	does the action have the privs to commit?

move translation discussions into docs
	https://github.com/orgs/neomutt/discussions/categories/translators
	pin one entry linking everything

------------------------------------------------------------

Change all parse_*() function warning messages to include prototype, e.g.
	"color: too few arguments"
	"color [attrs] fg bg [regex [num]"
	link to web help page?
for :commands given with zero args
	if not valid, show usage
	:lua-console -> lua-console [show|hide|toggle|reset]
	or, if command can be used with zero args, allow :xyz? ('?' suffix)
	check all commands for compatibility
	show one-line help!
	trap ":command?<enter>" at parse phase, so each handler doesn't have to
	handlers will need to deal with ":command<enter>"

fix numbering!
	enum CommandResult
	{
	MUTT_CMD_ERROR   = -1, ///< Error: Can't help the user
	MUTT_CMD_WARNING = -2, ///< Warning: Help given to the user
	MUTT_CMD_SUCCESS =  0, ///< Success: Command worked

prelude to [linear]
	âˆ€ commands and their global data

âˆ€ command - where do they store their data?

turn all "too (few|many) arguments" into command help with prototype

âˆ€ commands (that take min of 1 param)
	if (!MoreArgs(line))
	  return too_few_args(cmd); // MUTT_CMD_WARNING
	can be expanded to print the cmd help/prototype/etc
	NO.  âˆ€ "too few" or "too many" code paths

command parsing:
	consume_line() for if (OptGui), etc
	use up the line up to eol or `;`
	using parse_extract_token()

need links in "Configuration Commands" for
	lua, lua-source, echo, version, tag-formats, tag-transforms

refactor command parsing again...
	pure *parse* routine -- just doing arg splitting, etc
	returns a struct ParsedXCommand (might be trivial)
	this can be thoroughly tested
	a small 'doing' part that saves the result, sends notifications, etc
	can the parsing part be broken up and parts reused?
	parse_get_regex(line)
	hook code is highly repetitive

add folder-hook-late (once mailbox is open and index populated)

prefix for help pages could be an slist
	"file:///usr/share/doc/neomutt,http://neomutt.org/docs"

enum WarnArgCount
{
  WAC_TOO_FEW,         ///< Too few  arguments
  WAC_TOO_MANY,        ///< Too many arguments
};

enum CommandResult warn_arg_count(const struct Command *cmd, enum WarnArgCount count)
{
}

rc = warn_arg_count(cmd, WAC_TOO_FEW, err);

BufferPool
	memset() in buf_pool_get()
	rather than buf_pool_release()
	to avoid "Uncontrolled data used in path expression" false positives

config parsing
	deglobalise file stack (x includes y includes z)
	pass as a param to parsers
	use stack to show "backtrace" to error
	struct ListHead MuttrcStack

have ALL commands have data pointing to their *Module*
	handler function
		calls parser function -> struct CommandXData[]
		validates it
		saves it to the *Module* data
	no global variables
	all parses are testable

add AI dev docs to docs.neomutt.org

pygmentize create custom lexer for neomuttrc for website

create a way to have colour patterns applied dynamically
	~(X) => the THREAD of pattern X
	~(~m .) => the THREAD of the current message
		similar to <tag-thread> (Alt-t)
	~>(~m .) => Tag the message whose child is the current message
		i.e. tag my parent
	~>(~>(~m .)) => Tag my grand-parent
Using these sorts of patterns, you could dynamically:
	highlight the current thread (with a faint background colour)
	highlight the parent of the current message
	highlight the grand-parent of the current message
Would be useful to be able to invalidate individual Menu items
	targetted repainting
deep tree
	uncolor index *
	color index #ff8080 default "~>(~m .)
	color index #ffff80 default "~>(~>(~m .))"
	color index #ff80ff default "~>(~>(~>(~m .))")
	color index #80ffff default "~>(~>(~>(~>(~m .))))"
	color index #8080ff default "~>(~>(~>(~>(~>(~m .)))))"
	color index #80ff80 default "~>(~>(~>(~>(~>(~>(~m .))))))"
	difficult to evaluate -- needs to know current selection
	could define these objects, as they're useful
		index_current_thread
		index_parent{1,2,3,4,5,6,7,8,9}

find all (neo)mutt guides on the web
	put them all in a temp private repo
	along with all our docs
		guide, man pages, dyk tips
	get AI to summarise them / improve them

after [linear] create variant of -Z / -z that dumps to stdout
	no curses, just check the mailboxes; use $index_format
	width of $COLUMNS or 80
	print mailbox name (bold)
	abbreviate with $folder
	print account name (if multiple)
after [linear] add cli Lua scripting query option
	allows users to construct complex queries
	start up neomutt, sans GUI
	run lua script
	allow lua to navigate, calculate and output to stdout
	then exit

change default keybindings to include a flag
	DEFAULT -- this should be restored after "unbind *"
	does this work?
	we set default bindings at startup,
	but the menus don't keep a handle to the data
probably won't work
	a Menu could add multiple "default bindings"
	the user could unbind them all
	the Menu would have to keep an array of Bindings lists

pattern completion -> pattern help page not documented
	need to extend to support other pattern leaders
	~<tab> works, =<tab>, %<tab> don't
	see complete_pattern()
general auto-completion docs?
	CompleteOps::complete()
	alias/complete.c:39:61:    complete_alias_complete - Complete an Alias
	alias/complete.c:68:64:    complete_alias_query    - Complete an Alias Query
	alias/complete.c:93:59:    complete_alias          - Alias completion wrapper
	notmuch/complete.c:211:62: complete_nm_query       - Complete a Notmuch Query
	notmuch/complete.c:228:58: complete_nm_tag         - Complete a Notmuch Tag
	pattern/complete.c:39:63:  complete_pattern        - Complete a NeoMutt Pattern
	browser/complete.c:43:57:  complete_file_mbox      - Complete a Mailbox
	browser/complete.c:110:60: complete_file_simple    - Complete a filename
	complete/helpers.c:439:63: complete_command        - Complete a NeoMutt Command
	complete/helpers.c:464:51: complete_label          - Complete a label
doc capabilities/limitations of each handler
pattern docs don't match pattern auto-completion help
	cf mutt

post [linear] need to revisit Makefile link order

liblog(ging)?
	/mutt_logging.[ch]
	mutt/mutt_logging.[ch]
hmm... libmutt relies on logging and logging on libmutt

test-lua-scripts repo
	post link to discussion
	rebase [lua] first

different tmp files
	Different tmpdir settings for drafts and attachments
	https://gitlab.com/muttmua/mutt/-/issues/65
- drafts should probably go to `$XDG_CACHE_HOME` (**not** `/var/tmp`);
- truly temporary files should probably go to `$XDG_RUNTIME_DIR` (**not** `/tmp`).
use `drafts_dir`?
	is it time to rename *postpone* -> *draft*?

check doxy comments for
	mutt_save_path - Turn an email address into a filename (for saving)
	buf_save_path - Make a safe filename from an email address
	mutt_safe_path - Make a safe filename from an email address

recheck dependencies of libmutt

analyse âˆ€ config options in /mutt_config.c
	who uses them?
	do they have a dedicated library/config
	suggest helper functions
	suggest encapsulation
	refs: cs_*(), query_quadoption(), bool, multichoice?
	give explicit list

WKD
	When sending encrypted mail, if keys are missing, fetch them from the network (WKD, DANE, etc)
	https://gitlab.com/muttmua/mutt/-/issues/55
	https://github.com/wiktor-k/mutt/commits/master

POST copilot feature discoverability ideas in discussion
	ping __monty__

add a 'commands' page to `?` <help> with a one-liner description of each
	or :help <topic>
	if `:help TEXT` and `TEXT` isn't a help topic try to guess
	if `TEXT` is a command -> `help command TEXT`
	same for functions, config options
	also redirect `:hooks` -> `help hooks`
	`color` -> `help colors`
	`set` -> `help config`
	`setenv` -> `help env`
	`bind`/`macro` -> `help keys`
	`version` -> `help about`
:help-grep
	`help UNKNOWN` shows a menu of possible help topics

:help
	need modules to register themselves
	existing info: bind, color, hooks, macro, set, setenv, version
	add: about, changelog, tips, dyk
	<help> / `?` equivalent to `help keys`?
		how is this dialog-specific?
	need auto-completion for all help topics

history could do with a <limit> option
	or live search/filter
	need way to extract code to apply it elsewhere
	need way to generically mark objects (in)visible
need API to marshall data - libfilter or liblimit
	get_text() -- cache it
	mark_visible(bool)

fuzzer: try fuzzing with ASAN
	define-append CFLAGS -fsanitize=fuzzer,address
	define-append LDFLAGS -fsanitize=fuzzer,address
	https://llvm.org/docs/LibFuzzer.html
	asan doesn't show up in `ldd` output
	nm -D fuzz/cli-fuzz 2>/dev/null | grep -E '(__asan_|LLVMFuzzerTestOneInput|__ubsan_)'

update cifuzz target with cli fuzzer
	-max_total_time=60

main: remove TESTs
	post linear, restore them

CLI flag to warn on synonyms/deprecated config/commands/etc
	-w (warnings)
	pass flag to ParseContext
	preserve âˆ€ parsing done later
		NeoMutt->warnings = true;
	LL_WARNING (unless -Werror CLI flag)
all commands go through parse_rc_line()
	so add flag to the ParseContext
	or config option: enum: [ignore,log,warn,error]
		ignore: do nothing (do we need this option?)
		log: logs only
		warn: warning messages, but continue
		error: error message, stop processing

easy: mxapi: mbox_create/delete()
then add to browser, need exists fn too

relative 'source'ing of files doesn't work if the base is a symlink

2016-10-25 11:04 <mgedmin>
	pet peeve: when I try to open a gigabyte-sized mbox file with 10,000 messages, I cannot abort that

use skills or agents to break up copilot instructions
https://docs.github.com/en/copilot/concepts/agents/about-agent-skills
https://docs.github.com/en/copilot/how-tos/use-copilot-agents/coding-agent/create-custom-agents
	docs
		dyk
	tester
	coverage
	builder -- need deps to build ALL possible configurations
	debugger
	asan
	refactoring
	release engineer
	translation -- don't --disable-nls

:cd (no params) -> `cd $HOME`
need matching :pwd
	what does cd actually do / affect?
	status expando for cwd
	%{cwd}

create tunnel example config
	neomutt -f imaps://servername/ setup (with an account-hook that sets tunnel='ssh -q servername /usr/lib/dovecot/imap')

folder-hooks: doc that
	`folder-hook`s work also both with mailbox labels _and_ notmuch:// definitions

account-hook recursion check
	void exec_account_hook(const char *url)
	add logging to `if (inhook) return`

extend ParseContext/ParseError to pattern parsing
	and config parsing

compose attachments don't honour <tag-prefix> / $auto_tag
	tested with `d` (`<delete-entry>`)
	(check upstream behaviour)
	list affected compose functions
	just detach?
combos
	auto_tag	Y,N
	tagged		0,1,3
	action		E,T

howto Menus - selection, tagging, auto_tag

move usage.c to cli/ ?
	usage.c needs version.h needs gui, etc

post libparse refactor into XYZ, XYZ_args, XYZ_exec
	pass --deprecated flag to parsers
		removes "max warnings limit"
	create standalong config reader
	recursively parse ALL config
		syntax, command names, config names
	post-process command-bearing hooks for validity
	log verbosely to terminal in quickfix format
	log old %?VAR?TRUE&FALSE? style conditionals
		and their replacement
	if deprecated need to explain why / suggest alternative
extra hints?
	enums/numbers don't need to be quoted
	suggest %{long-name} expandos
	suggest %<X?TRUE&FALSE> conditionals
	suggest bool use yes/no (rather than true/false/1/0 etc)

update vim syntax âˆ€
	update compose colours to include underscored versions
	automate this?
		need list of all updatable sections
		need list of data sources
		need list of exceptions
		synonyms, deprecated

status_format %{uptime}
	for debugging / prowess
	add %{uptime-short}
	or a :uptime command

https://github.com/termstandard/colors
	move neomutt into "supported"

`make; make distclean` seems to leave `docs/.keepme` behind

PGP keys: %[strftime] displays `timestamp`
	`timestamp` is creation time
	`expires` is expiry time -- probably useful
	need more expandos
	could use %{strtime}
Then add %{long-name}s for abbreviated time
	%{creation-time}
	%{creation-time-short}
	%{expiry-time}
	%{expiry-time-short}

add (X days ago) to signatures
	look for sig->timestamp
	subkey->timestamp
	anywhere else we display full ISO date?
	"%Y-%m-%d" ?
	print_time()
	mutt_date_make_imap()
	mutt_date_make_tls()
	browser? relative date field
		lua config-cycler!
	pgp_gpgme_extract_keys()

relative dates config to customise
	relative_timestamps="90m,72h,21d,8w,24M"
	=> minutes count up to 90, then hours
	=> hours count up to 72, then days
	=> days count up to 21, then weeks
	=> weeks count up to 8, then months
	=> months count up to 24, then years
a zero value would mean skip that section, e.g 0w (days -> months)

relative dates in the Index =>
	every 1min we should repaint the current page
		and recalc colours?
	should cache $relative_timestamps
	this is needed if `%<>` conditionals or `%@NAME@` is used
do the same for sizes
	for bytes, KiB, MiB, GiB

bash-completion
	push upstream to https://github.com/scop/bash-completion/

These functions are users of config options:
	query_quadoption()
	query_yesorno_help()
	cs_subset_bool()
	cs_subset_enum()
	cs_subset_long()
	cs_subset_mbtable()
	cs_subset_number()
	cs_subset_path()
	cs_subset_quad()
	cs_subset_regex()
	cs_subset_slist()
	cs_subset_sort()
	cs_subset_string()
	cs_subset_expando()
examine all the config options, in `mutt_config.c` and `*/config.c`.
for each option, find all the places it's used.
list all the options that would be better suited in a different file.

pending.txt alias pend

github - examine, remove
	github/devel/docs
	github/devel/docs-1

